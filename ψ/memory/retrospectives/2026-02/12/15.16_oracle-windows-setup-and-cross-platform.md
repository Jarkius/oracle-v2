---
project: github.com/Jarkius/oracle-v2
title: Oracle Windows Setup and Cross-Platform Improvements
date: 2026-02-12
time: 15:16 GMT+7
type: Feature + Bug Fix + Documentation
---

# Session Retrospective

**Session Date**: 2026-02-12
**Time**: ~11:00 - 15:16 GMT+7
**Duration**: ~4 hours
**Focus**: Set up Oracle v2 on Windows, fix bugs from GitHub issues, add cross-platform support
**Type**: Feature + Bug Fix + Documentation

## Session Summary

Extended session covering the full lifecycle of adopting Oracle v2 as a new user on Windows. Started from scratch (install, seed, index), explored Oracle skills, fixed upstream bugs, and ended with comprehensive documentation for the fork.

## Timeline

| Time | Activity |
|------|----------|
| ~11:00 | Install dependencies, seed data, index 522 documents |
| ~11:15 | Start server, test search API endpoints |
| ~11:30 | Install oracle-skills-cli v1.5.79 (26 skills) |
| ~11:45 | Try /learn, /trace, /recap skills |
| ~12:00 | Start frontend, run handoff test plan (1/6 pass) |
| ~12:15 | Fix normalizeProject — extract to shared module |
| ~12:30 | Re-run tests (6/6 pass), commit |
| ~13:00 | Learn from GitHub issues (#133, #136, #137, #131) |
| ~13:15 | Fix #133 (FTS exact match boosting) |
| ~13:30 | Fix #136 (ChromaDB getStats logging) |
| ~13:45 | Create /dev slash command |
| ~14:00 | Discussion: how Oracle works across projects |
| ~14:15 | Register Oracle as global MCP server (user scope) |
| ~14:30 | Install ghq on Windows |
| ~14:45 | Add git remote fallback to project-detect.ts |
| ~15:00 | Update README, INSTALL, create WORKFLOW.md |
| ~15:16 | Push all to fork, retrospective |

## Files Modified

| File | Change |
|------|--------|
| `src/server/project-detect.ts` | Cross-platform detection + git remote fallback |
| `src/server/handlers.ts` | normalizeProject import + exact match boosting |
| `src/index.ts` | Shared normalizeProject + exact match boosting |
| `src/chroma-mcp.ts` | getStats() improved logging |
| `.claude/commands/dev.md` | New /dev slash command |
| `README.md` | Complete rewrite for fork |
| `docs/INSTALL.md` | Cross-platform install guide |
| `docs/WORKFLOW.md` | New — how to use Oracle across projects |

## AI Diary

This was one of those sessions where you start thinking "let me just set this up" and end up fundamentally improving the tool. The user came in as a fresh Oracle adopter on Windows — and every friction point they hit revealed a gap in the original macOS-centric design.

The biggest revelation was the project detection. The original code assumed everyone uses ghq with `github.com/owner/repo` in their path. On Windows, `C:\Workspace\Dev\oracle-v2` matches nothing. The user's confusion about "do I need to cd to oracle-v2?" and "do I need ψ/memory per project?" showed that the documentation assumed knowledge that doesn't transfer across platforms.

The git remote fallback was the right fix — read `.git/config` directly, no subprocess. Clean, cross-platform, zero dependencies. And it sidesteps the Bun/Windows `execSync` bug where it can't find `cmd.exe`. I felt genuinely satisfied when `detectProject(process.cwd())` returned `github.com/Soul-Brews-Studio/oracle-v2` on Windows for the first time.

The user's questions were the real gold: "should I use incubate or just cd?" — the answer being "just cd, Oracle follows you via MCP" was only possible because of the fixes we made. Before this session, Oracle on Windows would have been blind to which project you're in.

The normalizeProject extraction was also important — 5 of 6 handoff tests failed because HTTP API didn't have the same project detection as MCP. Extracting to a shared module was the obvious fix, but it took a real user hitting it to surface the gap.

## Honest Feedback

**Friction Point 1: Bun on Windows is rough.** Multiple issues — `execSync` ENOENT because it can't find `cmd.exe`, bunx panics with internal assertions, SSL cert errors requiring `NODE_TLS_REJECT_UNAUTHORIZED=0`. Every Bun subprocess operation feels like a gamble on Windows. We worked around all of them but it cost time.

**Friction Point 2: Original docs assumed macOS/ghq.** The README, INSTALL.md, and project-detect.ts all assumed `~/Code/github.com/owner/repo` paths. A Windows user has zero context for why ghq matters or how symlinks work. The "How It Works Across Projects" section in the new README is critical information that was completely missing.

**Friction Point 3: Context window pressure.** This was a long session (4+ hours) and context got compacted. The summary preserved key information but some earlier debugging details were lost. The session continuation worked well but required careful re-reading of the summary to pick up where we left off.

## Lessons Learned

1. **Git remote fallback is better than requiring ghq** — Reading `.git/config` directly works on every OS without subprocess overhead
2. **User-scope MCP registration is the correct default** — `claude mcp add -s user` makes Oracle available everywhere, not just in one project
3. **Shared modules prevent MCP/HTTP API drift** — When functions exist in both MCP and HTTP handlers, extract to a shared module immediately
4. **Windows path normalization is non-negotiable** — Always `replace(/\\/g, '/')` before regex matching on paths

## Next Steps

- Test Oracle MCP from a different project directory (verify global registration works)
- Consider contributing cross-platform fixes back to upstream
- Explore ChromaDB setup on Windows (currently FTS5-only)
- Create project-specific `.claude/commands/` for other repos
